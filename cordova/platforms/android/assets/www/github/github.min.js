"use strict";!function(b,a){"function"==typeof define&&define.amd?define(["es6-promise","base-64","utf8","axios"],function(f,e,d,c){return b.Github=a(f,e,d,c)}):"object"==typeof module&&module.exports?module.exports=a(require("es6-promise"),require("base-64"),require("utf8"),require("axios")):b.Github=a(b.Promise,b.base64,b.utf8,b.axios)}(this,function(d,b,g,f){function c(h){return b.encode(g.encode(h))}d.polyfill&&d.polyfill();var a=function(j){j=j||{};var h=j.apiUrl||"https://api.github.com",k=a._request=function(t,p,q,o,m){function s(){var l=p.indexOf("//")>=0?p:h+p;if(l+=/\?/.test(l)?"&":"?",q&&"object"==typeof q&&["GET","HEAD","DELETE"].indexOf(t)>-1){for(var n in q){q.hasOwnProperty(n)&&(l+="&"+encodeURIComponent(n)+"="+encodeURIComponent(q[n]))}}return l.replace(/(&timestamp=\d+)/,"")+("undefined"!=typeof window?"&timestamp="+(new Date).getTime():"")}var e={headers:{Accept:m?"application/vnd.github.v3.raw+json":"application/vnd.github.v3+json","Content-Type":"application/json;charset=UTF-8"},method:t,data:q?q:{},url:s()};return(j.token||j.username&&j.password)&&(e.headers.Authorization=j.token?"token "+j.token:"Basic "+c(j.username+":"+j.password)),f(e).then(function(l){o(null,l.data||!0,l.request)},function(l){304===l.status?o(null,l.data||!0,l.request):o({path:p,request:l.request,error:l.status})})},i=a._requestAllPages=function(n,l){var p=[];!function m(){k("GET",n,null,function(s,o,q){if(s){return l(s)}o instanceof Array||(o=[o]),p.push.apply(p,o);var e=(q.getResponseHeader("link")||"").split(",").filter(function(r){return/rel="next"/.test(r)}).map(function(r){return(/<(.*)>/.exec(r)||[])[1]}).pop();e?(n=e,m()):l(s,p,q)})}()};return a.User=function(){this.repos=function(m,l){"function"==typeof m&&(l=m,m={}),m=m||{};var q="/user/repos",p=[];p.push("type="+encodeURIComponent(m.type||"all")),p.push("sort="+encodeURIComponent(m.sort||"updated")),p.push("per_page="+encodeURIComponent(m.per_page||"100")),m.page&&p.push("page="+encodeURIComponent(m.page)),q+="?"+p.join("&"),i(q,l)},this.orgs=function(l){k("GET","/user/orgs",null,l)},this.gists=function(l){k("GET","/gists",null,l)},this.notifications=function(q,m){"function"==typeof q&&(m=q,q={}),q=q||{};var u="/notifications",n=[];if(q.all&&n.push("all=true"),q.participating&&n.push("participating=true"),q.since){var l=q.since;l.constructor===Date&&(l=l.toISOString()),n.push("since="+encodeURIComponent(l))}if(q.before){var p=q.before;p.constructor===Date&&(p=p.toISOString()),n.push("before="+encodeURIComponent(p))}q.page&&n.push("page="+encodeURIComponent(q.page)),n.length>0&&(u+="?"+n.join("&")),k("GET",u,null,m)},this.show=function(m,l){var n=m?"/users/"+m:"/user";k("GET",n,null,l)},this.userRepos=function(p,l,r){"function"==typeof l&&(r=l,l={});var q="/users/"+p+"/repos",m=[];m.push("type="+encodeURIComponent(l.type||"all")),m.push("sort="+encodeURIComponent(l.sort||"updated")),m.push("per_page="+encodeURIComponent(l.per_page||"100")),l.page&&m.push("page="+encodeURIComponent(l.page)),q+="?"+m.join("&"),i(q,r)},this.userStarred=function(m,l){i("/users/"+m+"/starred?type=all&per_page=100",l)},this.userGists=function(m,l){k("GET","/users/"+m+"/gists",null,l)},this.orgRepos=function(m,l){i("/orgs/"+m+"/repos?type=all&&page_num=1000&sort=updated&direction=desc",l)},this.follow=function(m,l){k("PUT","/user/following/"+m,null,l)},this.unfollow=function(m,l){k("DELETE","/user/following/"+m,null,l)},this.createRepo=function(m,l){k("POST","/user/repos",m,l)}},a.Organization=function(){this.createRepo=function(m,l){k("POST","/orgs/"+m.orgname+"/repos",m,l)}},a.Repository=function(v){function q(o,l){return o===m.branch&&m.sha?l(null,m.sha):void x.getRef("heads/"+o,function(r,e){m.branch=o,m.sha=e,l(r,e)})}var w,s=v.name,p=v.user,n=v.fullname,x=this;w=n?"/repos/"+n:"/repos/"+p+"/"+s;var m={branch:null,sha:null};this.getRef=function(o,l){k("GET",w+"/git/refs/"+o,null,function(r,u,t){return r?l(r):void l(null,u.object.sha,t)})},this.createRef=function(o,l){k("POST",w+"/git/refs",o,l)},this.deleteRef=function(e,l){k("DELETE",w+"/git/refs/"+e,v,l)},this.deleteRepo=function(e){k("DELETE",w,v,e)},this.listTags=function(l){k("GET",w+"/tags",null,l)},this.listPulls=function(u,o){u=u||{};var r=w+"/pulls",l=[];"string"==typeof u?l.push("state="+u):(u.state&&l.push("state="+encodeURIComponent(u.state)),u.head&&l.push("head="+encodeURIComponent(u.head)),u.base&&l.push("base="+encodeURIComponent(u.base)),u.sort&&l.push("sort="+encodeURIComponent(u.sort)),u.direction&&l.push("direction="+encodeURIComponent(u.direction)),u.page&&l.push("page="+u.page),u.per_page&&l.push("per_page="+u.per_page)),l.length>0&&(r+="?"+l.join("&")),k("GET",r,null,o)},this.getPull=function(o,l){k("GET",w+"/pulls/"+o,null,l)},this.compare=function(r,l,o){k("GET",w+"/compare/"+r+"..."+l,null,o)},this.listBranches=function(l){k("GET",w+"/git/refs/heads",null,function(e,u,r){return e?l(e):(u=u.map(function(o){return o.ref.replace(/^refs\/heads\//,"")}),void l(null,u,r))})},this.getBlob=function(o,l){k("GET",w+"/git/blobs/"+o,null,l,"raw")},this.getCommit=function(r,l,o){k("GET",w+"/git/commits/"+l,null,o)},this.getSha=function(r,l,o){return l&&""!==l?void k("GET",w+"/contents/"+l+(r?"?ref="+r:""),null,function(y,u,z){return y?o(y):void o(null,u.sha,z)}):x.getRef("heads/"+r,o)},this.getStatuses=function(o,l){k("GET",w+"/statuses/"+o,null,l)},this.getTree=function(o,l){k("GET",w+"/git/trees/"+o,null,function(r,u,t){return r?l(r):void l(null,u.tree,t)})},this.postBlob=function(o,l){o="string"==typeof o?{content:o,encoding:"utf-8"}:{content:c(o),encoding:"base64"},k("POST",w+"/git/blobs",o,function(r,u,t){return r?l(r):void l(null,u.sha,t)})},this.updateTree=function(z,o,u,l){var y={base_tree:z,tree:[{path:o,mode:"100644",type:"blob",sha:u}]};k("POST",w+"/git/trees",y,function(A,r,B){return A?l(A):void l(null,r.sha,B)})},this.postTree=function(o,l){k("POST",w+"/git/trees",{tree:o},function(r,u,t){return r?l(r):void l(null,u.sha,t)})},this.commit=function(o,y,z,l){var e=new a.User;e.show(null,function(t,r){if(t){return l(t)}var u={message:z,author:{name:v.user,email:r.email},parents:[o],tree:y};k("POST",w+"/git/commits",u,function(B,A,C){return B?l(B):(m.sha=A.sha,void l(null,A.sha,C))})})},this.updateHead=function(r,l,o){k("PATCH",w+"/git/refs/heads/"+r,{sha:l},o)},this.show=function(l){k("GET",w,null,l)},this.contributors=function(r,l){l=l||1000;var o=this;k("GET",w+"/stats/contributors",null,function(u,t,e){return u?r(u):void (202===e.status?setTimeout(function(){o.contributors(r,l)},l):r(u,t,e))})},this.collaborators=function(l){k("GET",w+"/collaborators",null,l)},this.isCollaborator=function(o,l){k("GET",w+"/collaborators/"+o,null,l)},this.contents=function(r,l,o){l=encodeURI(l),k("GET",w+"/contents"+(l?"/"+l:""),{ref:r},o)},this.fork=function(l){k("POST",w+"/forks",null,l)},this.listForks=function(l){k("GET",w+"/forks",null,l)},this.branch=function(o,l,r){2===arguments.length&&"function"==typeof arguments[1]&&(r=l,l=o,o="master"),this.getRef("heads/"+o,function(t,u){return t&&r?r(t):void x.createRef({ref:"refs/heads/"+l,sha:u},r)})},this.createPullRequest=function(o,l){k("POST",w+"/pulls",o,l)},this.listHooks=function(l){k("GET",w+"/hooks",null,l)},this.getHook=function(o,l){k("GET",w+"/hooks/"+o,null,l)},this.createHook=function(o,l){k("POST",w+"/hooks",o,l)},this.editHook=function(r,l,o){k("PATCH",w+"/hooks/"+r,l,o)},this.deleteHook=function(o,l){k("DELETE",w+"/hooks/"+o,null,l)},this.read=function(r,l,o){k("GET",w+"/contents/"+encodeURI(l)+(r?"?ref="+r:""),null,o,!0)},this.remove=function(r,l,o){x.getSha(r,l,function(e,t){return e?o(e):void k("DELETE",w+"/contents/"+l,{message:l+" is removed",sha:t,branch:r},o)})},this["delete"]=this.remove,this.move=function(r,u,t,l){q(r,function(o,e){x.getTree(e+"?recursive=true",function(y,z){z.forEach(function(A){A.path===u&&(A.path=t),"tree"===A.type&&delete A.sha}),x.postTree(z,function(A,B){x.commit(e,B,"Deleted "+u,function(C,D){x.updateHead(r,D,l)})})})})},this.write=function(B,z,y,A,o,l){"function"==typeof o&&(l=o,o={}),x.getSha(B,encodeURI(z),function(t,e){var r={message:A,content:"undefined"==typeof o.encode||o.encode?c(y):y,branch:B,committer:o&&o.committer?o.committer:void 0,author:o&&o.author?o.author:void 0};t&&404!==t.error||(r.sha=e),k("PUT",w+"/contents/"+encodeURI(z),r,l)})},this.getCommits=function(B,y){B=B||{};var z=w+"/commits",o=[];if(B.sha&&o.push("sha="+encodeURIComponent(B.sha)),B.path&&o.push("path="+encodeURIComponent(B.path)),B.author&&o.push("author="+encodeURIComponent(B.author)),B.since){var A=B.since;A.constructor===Date&&(A=A.toISOString()),o.push("since="+encodeURIComponent(A))}if(B.until){var l=B.until;l.constructor===Date&&(l=l.toISOString()),o.push("until="+encodeURIComponent(l))}B.page&&o.push("page="+B.page),B.perpage&&o.push("per_page="+B.perpage),o.length>0&&(z+="?"+o.join("&")),k("GET",z,null,y)},this.isStarred=function(r,l,u){k("GET","/user/starred/"+r+"/"+l,null,u)},this.star=function(r,l,u){k("PUT","/user/starred/"+r+"/"+l,null,u)},this.unstar=function(r,l,u){k("DELETE","/user/starred/"+r+"/"+l,null,u)},this.createRelease=function(o,l){k("POST",w+"/releases",o,l)},this.editRelease=function(r,l,o){k("PATCH",w+"/releases/"+r,l,o)},this.getRelease=function(o,l){k("GET",w+"/releases/"+o,null,l)},this.deleteRelease=function(o,l){k("DELETE",w+"/releases/"+o,null,l)}},a.Gist=function(m){var l=m.id,n="/gists/"+l;this.read=function(o){k("GET",n,null,o)},this.create=function(p,o){k("POST","/gists",p,o)},this["delete"]=function(o){k("DELETE",n,null,o)},this.fork=function(o){k("POST",n+"/fork",null,o)},this.update=function(p,o){k("PATCH",n,p,o)},this.star=function(o){k("PUT",n+"/star",null,o)},this.unstar=function(o){k("DELETE",n+"/star",null,o)},this.isStarred=function(o){k("GET",n+"/star",null,o)}},a.Issue=function(m){var l="/repos/"+m.user+"/"+m.repo+"/issues";this.create=function(n,p){k("POST",l,n,p)},this.list=function(q,t){var r=[];for(var p in q){q.hasOwnProperty(p)&&r.push(encodeURIComponent(p)+"="+encodeURIComponent(q[p]))}i(l+"?"+r.join("&"),t)},this.comment=function(p,n,q){k("POST",p.comments_url,{body:n},q)},this.edit=function(p,q,n){k("PATCH",l+"/"+p,q,n)},this.get=function(n,p){k("GET",l+"/"+n,null,p)}},a.Search=function(m){var l="/search/",n="?q="+m.query;this.repositories=function(p,o){k("GET",l+"repositories"+n,p,o)},this.code=function(p,o){k("GET",l+"code"+n,p,o)},this.issues=function(p,o){k("GET",l+"issues"+n,p,o)},this.users=function(p,o){k("GET",l+"users"+n,p,o)}},a.RateLimit=function(){this.getRateLimit=function(l){k("GET","/rate_limit",null,l)}},a};return a.getIssues=function(i,h){return new a.Issue({user:i,repo:h})},a.getRepo=function(i,h){return h?new a.Repository({user:i,name:h}):new a.Repository({fullname:i})},a.getUser=function(){return new a.User},a.getOrg=function(){return new a.Organization},a.getGist=function(h){return new a.Gist({id:h})},a.getSearch=function(h){return new a.Search({query:h})},a.getRateLimit=function(){return new a.RateLimit},a});